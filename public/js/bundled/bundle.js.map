{"mappings":";;;;;;;ACAO,MAAM,4CAAa,CAAC;IACzB,MAAM,MAAM,EAAE,IAAI;IAElB,EAAE,UAAU,kDAAkD;QAC5D,aACE;IACJ,GAAG,MAAM;IAET,MAAM,YAAY,EAAE,KAAK;QACvB,SAAS;QACT,UAAU;YAAC;YAAI;SAAG;QAClB,YAAY;YAAC;YAAI;SAAG;QACpB,aAAa;YAAC;YAAG;SAAI;IACvB;IAEA,2BAA2B;IAC3B,MAAM,SAAS,EAAE;IACjB,UAAU,QAAQ,CAAC;QACjB,gBAAgB;QAChB,OAAO,KAAK;YAAC,IAAI,WAAW,CAAC,EAAE;YAAE,IAAI,WAAW,CAAC,EAAE;SAAC;QAEpD,cAAc;QACd,EAAE,OAAO;YAAC,IAAI,WAAW,CAAC,EAAE;YAAE,IAAI,WAAW,CAAC,EAAE;SAAC,EAAE;YAAE,MAAM;QAAU,GAClE,MAAM,IACP,YAAY;SACX,UAAU,CAAC,QAAQ,EAAE,IAAI,IAAI,EAAE,EAAE,IAAI,YAAY,KAAK,CAAC,EAAE;YACxD,WAAW;QACb,GACC;IACL;IAEA,6CAA6C;IAC7C,MAAM,SAAS,EAAE,aAAa,QAAQ,IAAI;IAC1C,IAAI,UAAU;AAEd,wBAAwB;AACxB,gCAAgC;AAClC;;;;AErCO,MAAM,4CAAY;IACvB,MAAM,KAAK,SAAS,cAAc;IAClC,IAAI,IAAI,GAAG,cAAc,YAAY;AACvC;AAGO,MAAM,4CAAY,CAAC,MAAM;IAC9B;IACA,MAAM,SAAS,CAAC,yBAAyB,EAAE,KAAK,EAAE,EAAE,IAAI,MAAM,CAAC;IAC/D,SAAS,cAAc,QAAQ,mBAAmB,cAAc;IAChE,OAAO,WAAW,2CAAW;AAC/B;;;ADRO,MAAM,4CAAQ,OAAO,OAAO;IACjC,IAAI;QACF,MAAM,MAAM,MAAM,CAAA,GAAA,sCAAI,EAAE;YACtB,QAAQ;YACR,KAAK;YACL,MAAM;uBACJ;0BACA;YACF;QACF;QAEA,IAAI,IAAI,KAAK,WAAW,WAAW;YACjC,CAAA,GAAA,yCAAQ,EAAE,WAAW;YACrB,OAAO,WAAW;gBAChB,SAAS,OAAO;YAClB,GAAG;QACL;IACF,EAAE,OAAO,KAAK;QACZ,CAAA,GAAA,yCAAQ,EAAE,SAAS,IAAI,SAAS,KAAK;IACvC;AACF;AAEO,MAAM,4CAAS;IACpB,IAAI;QACF,MAAM,MAAM,MAAM,CAAA,GAAA,sCAAI,EAAE;YACtB,QAAQ;YACR,KAAK;QACP;QACA,IAAI,IAAI,KAAK,WAAW,WACtB,SAAS,OAAO;IAEpB,EAAE,OAAO,KAAK;QACZ,CAAA,GAAA,yCAAQ,EAAE,SAAS;IACrB;AACF;;;;;AEjCO,MAAM,4CAAiB,OAAO,MAAM;IACzC,IAAI;QACF,MAAM,MACJ,SAAS,aACL,wDACA;QACN,MAAM,MAAM,MAAM,CAAA,GAAA,sCAAI,EAAE;YACtB,QAAQ;iBACR;kBACA;QACF;QAEA,IAAI,IAAI,KAAK,WAAW,WACtB,CAAA,GAAA,yCAAQ,EAAE,WAAW,CAAC,EAAE,KAAK,cAAc,qBAAqB,CAAC;IAErE,EAAE,OAAO,KAAK;QACZ,CAAA,GAAA,yCAAQ,EAAE,SAAS,IAAI,SAAS,KAAK;IACvC;AACF;;;AJjBA,cAAc;AACd,MAAM,gCAAU,SAAS,eAAe;AACxC,MAAM,kCAAY,SAAS,cAAc;AACzC,MAAM,kCAAY,SAAS,cAAc;AACzC,MAAM,qCAAe,SAAS,cAAc;AAC5C,MAAM,yCAAmB,SAAS,cAAc;AAEhD,YAAY;AACZ,IAAI,+BAAS;IACX,MAAM,YAAY,KAAK,MAAM,8BAAQ,QAAQ;IAC7C,CAAA,GAAA,yCAAS,EAAE;AACb;AAEA,IAAI,iCACF,gCAAU,iBAAiB,UAAU,CAAC;IACpC,EAAE;IACF,MAAM,QAAQ,SAAS,eAAe,SAAS;IAC/C,MAAM,WAAW,SAAS,eAAe,YAAY;IACrD,CAAA,GAAA,yCAAI,EAAE,OAAO;AACf;AAGF,IAAI,iCAAW,gCAAU,iBAAiB,SAAS,CAAA,GAAA,yCAAK;AAExD,IAAI,oCACF,mCAAa,iBAAiB,UAAU,CAAC;IACvC,EAAE;IACF,MAAM,OAAO,IAAI;IACjB,KAAK,OAAO,QAAQ,SAAS,eAAe,QAAQ;IACpD,KAAK,OAAO,SAAS,SAAS,eAAe,SAAS;IACtD,KAAK,OAAO,SAAS,SAAS,eAAe,SAAS,KAAK,CAAC,EAAE;IAC9D,QAAQ,IAAI;IACZ,CAAA,GAAA,yCAAa,EAAE,MAAM;AACvB;AAGF,IAAI,wCACF,mCAAa,iBAAiB,UAAU,OAAO;IAC7C,EAAE;IACF,SAAS,cAAc,uBAAuB,cAAc;IAC5D,MAAM,kBAAkB,SAAS,eAAe,oBAAoB;IACpE,MAAM,WAAW,SAAS,eAAe,YAAY;IACrD,MAAM,kBAAkB,SAAS,eAAe,oBAAoB;IACpE,MAAM,CAAA,GAAA,yCAAa,EACjB;yBAAE;kBAAiB;yBAAU;IAAgB,GAC7C;IAGF,SAAS,eAAe,oBAAoB,QAAQ;IACpD,SAAS,eAAe,YAAY,QAAQ;IAC5C,SAAS,eAAe,oBAAoB,QAAQ;IACpD,SAAS,cAAc,uBAAuB,cAAc;AAC9D","sources":["public/js/index.js","public/js/map.js","public/js/login.js","public/js/alerts.js","public/js/updateSettings.js"],"sourcesContent":["import '@babel/polyfill';\r\nimport { displayMap } from './map';\r\nimport { login, logout } from './login';\r\nimport { updateSettings } from './updateSettings';\r\n\r\n//DOM ELEMENTS\r\nconst leaflet = document.getElementById('map');\r\nconst loginForm = document.querySelector('.form--login');\r\nconst logOutBtn = document.querySelector('.nav__el--logout');\r\nconst userDataForm = document.querySelector('.form-user-data');\r\nconst userPasswordForm = document.querySelector('.form-user-password');\r\n\r\n//DELEGATION\r\nif (leaflet) {\r\n  const locations = JSON.parse(leaflet.dataset.locations);\r\n  displayMap(locations);\r\n}\r\n\r\nif (loginForm) {\r\n  loginForm.addEventListener('submit', (e) => {\r\n    e.preventDefault();\r\n    const email = document.getElementById('email').value;\r\n    const password = document.getElementById('password').value;\r\n    login(email, password);\r\n  });\r\n}\r\n\r\nif (logOutBtn) logOutBtn.addEventListener('click', logout);\r\n\r\nif (userDataForm) {\r\n  userDataForm.addEventListener('submit', (e) => {\r\n    e.preventDefault();\r\n    const form = new FormData();\r\n    form.append('name', document.getElementById('name').value);\r\n    form.append('email', document.getElementById('email').value);\r\n    form.append('photo', document.getElementById('photo').files[0]);\r\n    console.log(form);\r\n    updateSettings(form, 'data');\r\n  });\r\n}\r\n\r\nif (userPasswordForm) {\r\n  userDataForm.addEventListener('submit', async (e) => {\r\n    e.preventDefault();\r\n    document.querySelector('.btn--save-password').textContent = 'Updating...';\r\n    const passwordCurrent = document.getElementById('password-current').value;\r\n    const password = document.getElementById('password').value;\r\n    const passwordConfirm = document.getElementById('password-confirm').value;\r\n    await updateSettings(\r\n      { passwordCurrent, password, passwordConfirm },\r\n      'password'\r\n    );\r\n\r\n    document.getElementById('password-current').value = '';\r\n    document.getElementById('password').value = '';\r\n    document.getElementById('password-confirm').value = '';\r\n    document.querySelector('.btn--save-password').textContent = 'Save Password';\r\n  });\r\n}\r\n","export const displayMap = (locations) => {\r\n  const map = L.map('map');\r\n\r\n  L.tileLayer('https://tile.openstreetmap.org/{z}/{x}/{y}.png', {\r\n    attribution:\r\n      '&copy; <a href=\"https://www.openstreetmap.org/copyright\">OpenStreetMap</a> contributors',\r\n  }).addTo(map);\r\n\r\n  const greenIcon = L.icon({\r\n    iconUrl: '/img/pin.png',\r\n    iconSize: [32, 40], // size of the icon\r\n    iconAnchor: [16, 45], // point of the icon which will correspond to marker's location\r\n    popupAnchor: [0, -50], // point from which the popup should open relative to the iconAnchor\r\n  });\r\n\r\n  // Add locations to the map\r\n  const points = [];\r\n  locations.forEach((loc) => {\r\n    // Create points\r\n    points.push([loc.coordinates[1], loc.coordinates[0]]);\r\n\r\n    // Add markers\r\n    L.marker([loc.coordinates[1], loc.coordinates[0]], { icon: greenIcon })\r\n      .addTo(map)\r\n      // Add popup\r\n      .bindPopup(`<h2>Day ${loc.day}: ${loc.description}</h2>`, {\r\n        autoClose: false,\r\n      })\r\n      .openPopup();\r\n  });\r\n\r\n  // Set map bounds to include current location\r\n  const bounds = L.latLngBounds(points).pad(0.4);\r\n  map.fitBounds(bounds);\r\n\r\n  // Disable scroll on map\r\n  //map.scrollWheelZoom.disable();\r\n};\r\n","import axios from 'axios';\r\nimport { showAlert } from './alerts';\r\n\r\nexport const login = async (email, password) => {\r\n  try {\r\n    const res = await axios({\r\n      method: 'POST',\r\n      url: 'http://127.0.0.1:3000/api/v1/users/login',\r\n      data: {\r\n        email,\r\n        password,\r\n      },\r\n    });\r\n\r\n    if (res.data.status === 'success') {\r\n      showAlert('success', 'Logged in successfully');\r\n      window.setTimeout(() => {\r\n        location.assign('/');\r\n      }, 1500);\r\n    }\r\n  } catch (err) {\r\n    showAlert('error', err.response.data.message);\r\n  }\r\n};\r\n\r\nexport const logout = async () => {\r\n  try {\r\n    const res = await axios({\r\n      method: 'GET',\r\n      url: 'http://127.0.0.1:3000/api/v1/users/logout',\r\n    });\r\n    if (res.data.status === 'success') {\r\n      location.reload(true);\r\n    }\r\n  } catch (err) {\r\n    showAlert('error', 'Error logging out! Try again.');\r\n  }\r\n};\r\n","export const hideAlert = () => {\r\n  const el = document.querySelector('.alert');\r\n  if (el) el.parentElement.removeChild(el);\r\n};\r\n\r\n//type is 'success' or 'error'\r\nexport const showAlert = (type, msg) => {\r\n  hideAlert();\r\n  const markup = `<div class=\"alert alert--${type}\">${msg}</div>`;\r\n  document.querySelector('body').insertAdjacentHTML('afterbegin', markup);\r\n  window.setTimeout(hideAlert, 3000);\r\n};\r\n","import axios from 'axios';\r\nimport { showAlert } from './alerts';\r\n\r\n//type is either 'password' or 'data'\r\nexport const updateSettings = async (data, type) => {\r\n  try {\r\n    const url =\r\n      type === 'password'\r\n        ? 'http://127.0.0.1:3000/api/v1/users/updateMyPassword'\r\n        : 'http://127.0.0.1:3000/api/v1/users/updateMe';\r\n    const res = await axios({\r\n      method: 'PATCH',\r\n      url,\r\n      data,\r\n    });\r\n\r\n    if (res.data.status === 'success') {\r\n      showAlert('success', `${type.toUpperCase()} updated successfully`);\r\n    }\r\n  } catch (err) {\r\n    showAlert('error', err.response.data.message);\r\n  }\r\n};\r\n"],"names":[],"version":3,"file":"bundle.js.map","sourceRoot":"../../../"}